\chapter{Computational methodology} \label{chap:method}
To investigate atomic environments in materials, theoretical simulations are essential for gaining insights into local structures and properties. This chapter will discuss two computational methods: first-principles calculations and CALPHAD modeling. First-principles calculations based on density functional theory (DFT) are used to predict stable structures and the thermochemical properties of materials. CALPHAD modeling integrates experimental data and simulation strengths to develop comprehensive thermodynamic descriptions of materials and further predict phase relations for materials design.

\section{First-principles calculations} \label{method:sec:firstprinciples}
DFT-based first-principles calculations are used to obtain thermodynamic properties at 0 K at finite temperatures through quasi-harmonic approximation (QHA). The Helmholtz energy $F(V,T)$ as a function of volume ($V$) and temperature ($T$) in terms of QHA can be determined by \cite{shang2010first}:
\begin{equation} \label{method:eq:qhaF}
    F\left(V,T\right)=E\left(V\right)+F_{el}\left(V,T\right)+F_{vib}(V,T)
\end{equation}
where the first term $E\left(V\right)$ is static energy at 0 K without the zero-point vibrational energy. In the present work, a four-parameter Birch-Murnaghan (BM4) equation of state (EOS) \cite{shang2010first} as shown in (\ref{method:eq:EOS}) is used to obtain equilibrium properties at zero external pressure (P = 0 GPa), including the static energy E$_0$, volume (V$_0$), bulk modulus (B$_0$) and its pressure derivate (B$^\prime$).
\begin{equation} \label{method:eq:EOS}
    E\left(V\right)=a_1+a_2V^{-2/3}+a_3V^{-4/3}+a_4V^{-2}
\end{equation}
where $a_1$, $a_2$, $a_3$, and $a_4$ are fitting parameters. The second term in (\ref{method:eq:qhaF}), $F_{el}\left(V,T\right)$, represents the temperature-dependent thermal electronic contribution \cite{wang2004thermodynamic}:
\begin{equation} \label{method:eq:Fel}
    F_{el}(V,T)=E_{el}(V,T)-T\:S_{el}(V,T)
\end{equation}
where $E_{el}$ and $S_{el}$ are the internal energy and entropy of thermal electron excitations, respectively, which can be obtained by the electronic density of states (DOS). Note that the thermal electronic contribution to Helmholtz free energy is negligible for non-metal, considering the Fermi level lies in the band gap. The third term in (\ref{method:eq:qhaF}), $F_{vib}(V,T)$, represents the vibrational contribution \cite{wang2004thermodynamic, van2002effect} given by:
\begin{equation} \label{method:eq:Fvib}
    F_{vib}(V,T)=k_BT\sum_{q}\sum_{j}\ln{\left\{2\sinh{\left[\frac{\hbar\omega_j(q,V)}{2k_BT}\right]}\right\}}
\end{equation}
where $\omega_j\left(q,V\right)$ represents the frequency of the $j_{th}$ phonon mode at wave vector $q$ and volume $V$, and $\hbar$ the reduced Plank constant. 

The Vienna Ab initio Simulation Package (VASP) \cite{kresse1996efficient} is used for all DFT-based calculations in the present work. Detailed settings of first-principles calculations for intermetallic catalysts and molten salts are discussed in Section \ref{intermetallics:ssec:PdZnmodel} and \ref{moltensalts:ssec:FLiNaKCrmodel}.

\section{CALPHAD modeling} \label{method:sec:calphad}
In the CALPHAD method, the general form of Gibbs energy of a phase can be expressed as:
\begin{equation} \label{method:eq:Gm}
    G_m=\:^{srf}G_m-T\:^{cnf}S_m +\:^{phys}G_m +\:^{xs}G_m
\end{equation}
where $^{srf}G_m$ represents the surface of reference Gibbs energy, $T\:^{cnf}S_m$ is the ideal configurational entropy contribution to the Gibbs energy, $^{phys}G_m$ represents the contribution of physical models to the Gibbs energy, such as magnetic transitions, and $^{xs}G_m$ is the excess Gibbs energy describing the remaining part of the real Gibbs energy \cite{lukas2007computational}. Considering the atomic environments of each phase, various models are employed to describe these contributions to the Gibbs energy in the present work.

\subsection{Compound energy formalism} \label{method:ssec:CEF}
%Introducting paragraph
A crystalline solid phase may have crystallographically different sublattices and the constituents may prefer different sublattices. This is a form of long-range order (LRO) and must be included in the modeling \cite{lukas2007computational}. For the solution phase, where phase can vary with composition, compound energy formalism (CEF) \cite{hillert1970regular, sundman1981regular} is used to describe the Gibbs energy. In the CEF, the selection of sublattices typically corresponds to the crystallographic sublattices associated with different Wyckoff positions. For complex phases requiring many sublattices, simplifications are often made to reduce the number of sublattices. Each sublattice may be described with a stoichiometric coefficient and contain any number of species, i.e. atoms, molecules, ions, or vacancies. 

For example, a phase with two sublattices can be represented by the formula:
\begin{equation} \label{method:eq:CEFphasemodel}
    ({\rm A,B})_k({\rm C,D})_l
\end{equation}
where A and B are mixed on the first sublattice (I), and C and D are mixed on the second sublattice (II). $k$ and $l$ are the stoichiometric coefficients. The constitution of the phase is described by site fraction, $y$, e.g. $y_{J}^{(s)}$ represents the mole fraction of species $J$ on the $s$ sublattice. Thus, the summation of site fraction $y_{J}$ of species over each sublattice equals 1. In the limit, there will be only one type of species on each sublattice, this configuration is called endmember. Endmembers of the phase with model (\ref{method:eq:CEFphasemodel}) are (A)${_k}$(C)${_l}$, (A)${_k}$(D)${_l}$, (B)${_k}$(C)${_l}$, and (B)${_k}$(D)${_l}$. The surface of reference energy term in (\ref{method:eq:Gm}) can be expressed as:
\begin{equation} \label{method:eq:CEFGsrf}
    ^{srf}G_m=\sum y_i^{({\rm I})}y_j^{({\rm II})}\:^{o}G_{i:j}
\end{equation}
where $^{o}G_{i:j}$ is the Gibbs energy of the endmember compound ($i$)${_k}$($j$)${_l}$ (here $i$ = A and B, $j$ = C and D). The ideal configurational entropy contribution to the Gibbs energy is described as:
\begin{equation} \label{method:eq:CEFScnf}
    \begin{aligned}
        -T\:^{cnf}S_m&=RT\sum n_s \sum y_J^{(s)} \ln (y_J^{(s)})\\
        &=RT(k\sum_{i={\rm A,B}} y_i^{({\rm I})}\ln (y_i^{({\rm I})})+l\sum_{j={\rm C,D}} y_j^{({\rm II})}\ln (y_j^{({\rm II})}))
    \end{aligned}
\end{equation}
where $R$ is the ideal gas constant, $n_s$ is the stoichiometric coefficient of the sublattice $s$ (here $n_s$ = $k$ and $l$). The excess Gibbs energy is described as:
\begin{equation} \label{method:eq:CEFGxs}
    ^{xs}G_m=y_{\rm A}^{({\rm I})}y_{\rm B}^{({\rm I})}\sum_{j={\rm C,D}} y_j^{({\rm II})} L_{{\rm A,B}:j}+y_{\rm C}^{({\rm II})}y_{\rm D}^{({\rm II})}\sum_{i={\rm A,B}} y_i^{({\rm I})} L_{i:{\rm C,D}}+y_{\rm A}^{({\rm I})}y_{\rm B}^{({\rm I})}y_{\rm C}^{({\rm II})}y_{\rm D}^{({\rm II})}L_{{\rm A,B}:{\rm C,D}}
\end{equation}
where $L$ is the interaction parameters, which can be expanded in a Redlich-Kister polynomial \cite{redlich1948algebraic}. For example, binary interaction term $L_{{\rm A,B}: {\rm C}}$ in (\ref{method:eq:CEFGxs}) can be expressed as:
\begin{equation} \label{method:eq:CEFLabc}
    L_{{\rm A,B}: {\rm C}} = \sum_{v=0}(y_{\rm A}^{({\rm I})}-y_{\rm B}^{({\rm I})})^v\:^vL_{{\rm A, B:C}}
\end{equation}
forming the polynomial basis with increasing orders of $v$. The reciprocal interaction parameters are described by:
\begin{equation} \label{method:eq:CEFLabcd}
    L_{{\rm A,B}:{\rm C,D}}=^0L_{{\rm A,B}:{\rm C,D}}+(y_{\rm A}^{({\rm I})}-y_{\rm B}^{({\rm I})})\:^1L_{{\rm A,B}:{\rm C,D}}+(y_{\rm C}^{({\rm II})}-y_{\rm D}^{({\rm II})})\:^2L_{{\rm A,B}:{\rm C,D}}
\end{equation}
The temperature dependence of these excess parameters is often modeled by:
\begin{equation} \label{method:eq:CEFLT}
    ^vL= b_1 + b_2\:T +b_3T\ln T
\end{equation}
where $b_1$, $b_2$, and $b_3$ are adjustable parameters.

There are several cases of the CEF worth mentioning. A sublattice model
that has only one constituent in every sublattice will have no internal degrees of freedom
with a fixed composition. It is used as a model for the stoichiometric compound (or the line compound). In addition, the constituents on a sublattice may be a complex species instead of a pure element, for example, using an \textit{associate} to represent clusters of short-range ordering in the liquid, commonly referred to as the associate model \cite{sommer1982association} and will be discussed in Section \ref{method:sssec:assm}.

\subsection{Thermodynamic models for liquid} \label{method:ssec:liqmodels}
%Introducting paragraph
In the liquid phase, the constituents have no fixed environment and the number of nearest neighbors can vary. For the simple case, one sublattice model as shown in \ref{method:ssec:CEF} can be used to describe the random mixing of constituents in the liquid. However, for liquids with complex phenomena, such as short-range ordering (SRO) or ionic characteristics, alternative models are used to describe the Gibbs energy.

\subsubsection{Associate model} \label{method:sssec:assm}
%Introducting paragraph
To account for SRO, fictitious constituents, or \textit{associates}, are introduced in the model. For an experimentally determined sharp minimum in the enthalpy curve, the selection of stoichiometry of the associate usually corresponds to the composition of the minimum. For example, for a binary A-B liquid with AB associate introduced, the surface of reference Gibbs energy can be described as:
\begin{equation} \label{method:eq:assmGsrf}
    ^{srf}G_m=\sum_{i={\rm A,AB,B}} y_i\:^{o}G_{i}
\end{equation}
where the site fraction $y_i$ is used here to denote that the constituent fractions (A, AB, and B) are not the same as the mole fractions of the components (A and B). $^{o}G_{i}$ is the Gibbs energy of the constituent $i$. The ideal configurational entropy contribution can be expressed as:
\begin{equation} \label{method:eq:assmScnf}
    -T\:^{cnf}S_m=RT\sum_{i={\rm A,AB,B}}y_i\ln y_i
\end{equation}
where the summation of $i$ is over all the constituents (here $i$ = A, AB, and B). The excess Gibbs energy can be modeled as:
\begin{equation} \label{method:eq:assmGex}
    ^{xs}G_m=y_{\rm A}y_{\rm AB}L_{\rm A,AB}+y_{\rm AB}y_{\rm B}L_{\rm AB,B}+y_{\rm A}y_{\rm B}L_{\rm A,B}+y_{\rm A}y_{\rm AB}y_{\rm B}L_{\rm A,AB,B}
\end{equation}
where the interaction terms $L$ can also be expanded with Redlich-Kister polynomial \cite{redlich1948algebraic} as in (\ref{method:eq:CEFLT}).

\subsubsection{Two-sublattice ionic model} \label{method:sssec:ionic}
%Introducting paragraph

\subsubsection{Modified quasichemical model with quadruplets approximation} \label{method:ssec:mqmqa}

\subsection{Open-source software} \label{method:ssec:tools}
The model parameters are evaluated in two steps in ESPEI. The first step is parameter generation. In this step, the thermochemical data from DFT-based first-principles calculations with all internal degrees of freedom specified [30,39], such as site fractions in each sublattice, are used to select the number of parameters and evaluate their values. The experimental thermochemical data can also be used in the first step if their internal degrees of freedom are specified, such as stoichiometric compounds or fully random solutions. This is because the minimization of Gibbs energy for the internal variables is not performed in the first step. PDUQ relies on the PyCalphad for predicting thermodynamic properties of interest and ESPEI for Bayesian samples to leverage the distribution of model parameters and estimate uncertainties based on the estimated Gaussian distribution of input data uncertainty [14,16]. The statistical distributions of model parameters are evaluated from the samples during MCMC optimization based on the Metropolis criteria [14].


\section{Bayesian parameter estimation} \label{method:ssec:Bayesian}

\section{Summary} \label{method:ssec:summary}
%Introducting paragraph
